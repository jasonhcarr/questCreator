!function(){"use strict";angular.module("questCreator",["ui.router","LocalStorageModule"]).config(function(a,b){b.otherwise("/"),a.state("main",{abstract:!0,url:"/",templateUrl:"./src/views/main.html",controller:"mainCtrl as main"}).state("main.landing",{url:"",templateUrl:"./src/views/landing.html",controller:"landingCtrl as landing"}).state("main.game",{url:"game",templateUrl:"./src/views/game.html",controller:"gameCtrl as game"}).state("main.game.detail",{url:"/detail",templateUrl:"./src/views/game/detail.html",controller:"detailCtrl as detail"}).state("main.game.play",{url:"/play",templateUrl:"./src/views/game/play.html",controller:"playCtrl as play"}).state("main.game.editor",{abstract:!0,url:"/editor",templateUrl:"./src/views/game/editor.html",controller:"editorCtrl as editor"}).state("main.game.editor.views",{url:"/",views:{maps:{templateUrl:"./src/views/game/editor/map.html",controller:"mapCtrl as map"},scenes:{templateUrl:"./src/views/game/editor/scene.html",controller:"sceneCtrl as scene"},backgrounds:{templateUrl:"./src/views/game/editor/bg.html",controller:"bgCtrl as bg"},objects:{templateUrl:"./src/views/game/editor/obj.html",controller:"objCtrl as obj"},entities:{templateUrl:"./src/views/game/editor/ent.html",controller:"entCtrl as ent"},scripts:{templateUrl:"./src/views/game/editor/scripts.html",controller:"scriptsCtrl as scripts"}}}).state("main.profile",{url:"profile",templateUrl:"./src/views/profile.html",controller:"profileCtrl as profile"})})}(),angular.module("questCreator").factory("Avatar",function(){function a(a){this.name=a.name,this.obj=a.obj,this.user_id=a.user_id,this.current=a.current,this.action="stand"}return a.prototype.updatePos=function(){this.obj.pos.x+=this.obj.speed.x,this.obj.pos.y+=this.obj.speed.y},a.prototype.stop=function(){this.action="stand",this.obj.speed.x=0,this.obj.speed.y=0},a.prototype.collide=function(a){switch(this.stop(),a){case"left":this.obj.pos.x+=this.obj.speed.mag;break;case"right":this.obj.pos.x-=this.obj.speed.mag;break;case"up":this.obj.pos.y+=this.obj.speed.mag;break;case"down":this.obj.pos.y-=this.obj.speed.mag}},a}),angular.module("questCreator").factory("Background",function(){function a(a){this.name=a.name,this.obj=a.obj,this.game_id=a.game_id}return a}),angular.module("questCreator").factory("Entity",function(){function a(a){this.name=a.name,this.obj=a.obj,this.game_id=a.game_id,this.action="walkRight"}return a.prototype.updatePos=function(){this.obj.pos.x+=this.obj.speed.x,this.obj.pos.y+=this.obj.speed.y},a.prototype.stop=function(){this.action="stand",this.obj.speed.x=0,this.obj.speed.y=0},a.prototype.collide=function(a){switch(this.stop(),a){case"left":this.obj.pos.x+=this.obj.speed.mag;break;case"right":this.obj.pos.x-=this.obj.speed.mag;break;case"up":this.obj.pos.y+=this.obj.speed.mag;break;case"down":this.obj.pos.y-=this.obj.speed.mag}},a}),angular.module("questCreator").factory("SceneObject",function(){function a(a){this.name=a.name,this.obj=a.obj,this.game_id=a.game_id,this.action="none",this.allActions=[]}return a}),angular.module("questCreator").service("EditorService",function(a,b){function c(a){}function d(c){var d={user_id:a.get().id,token:a.get().token},e={name:c,description:"",tags:[]};console.log(d,e),$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/games/create",data:JSON.stringify(e),headers:d,dataType:"json",contentType:"application/json",success:function(a){return e=a},error:function(a){alert("There was a problem creating this game. Please try again."),b.go("main.landing")}})}return{getGame:c,createGame:d}}),angular.module("questCreator").service("GameService",function(){function a(a){$.ajax({method:"GET",url:"https://forge-api.herokuapp.com/games/load",data:JSON.stringify(a),dataType:"json",contentType:"application/json",success:function(a){return a},error:function(a){alert("There was a problem loading this game")}})}return{loadGame:a}}),angular.module("questCreator").service("socket",function(){var a=io();return{on:function(b,c){a.on(b,c)},emit:function(b,c){a.emit(b,c)},off:function(b,c){a.off(b,c)}}}),angular.module("questCreator").service("UserService",function(){function a(){return l}function b(a){l=a}function c(a){l.editGame=a}function d(){gapi.client.setApiKey(m),gapi.auth2.init({client_id:n,scope:"profile"}).then(function(){k=gapi.auth2.getAuthInstance(),console.log("Session authorized"),k.isSignedIn.listen(e),e(k.isSignedIn.get())})}function e(a){a?($("#login").hide(),$("#logout").show(),console.log("Signed In!"),h()):($("#login").show(),$("#logout").hide(),console.log("Signed Out!"))}function f(){k.signIn({prompt:"login"})}function g(){k.signOut()}function h(){var a=gapi.client.request({path:"https://people.googleapis.com/v1/people/me",method:"GET"});a.then(function(a){l.picture=a.result.photos[0].url,l.uid=k.currentUser.Ab.El,l.token=k.currentUser.Ab.Zi.access_token,$.ajax({method:"PATCH",url:"https://forge-api.herokuapp.com/users/login",data:{uid:l.uid,token:l.token},success:function(a){l.joined=a.created_at,l.username=a.username,l.id=a.id,$("#welcome").css("display","flex"),setTimeout(function(){$("#welcome").css("display","none")},2e3)},error:function(a){404===a.status?$("#register-form").css("display","flex"):0===a.status||(alert("There was a problem logging in. Please try again"),g())}})})}function i(a){l.username=a,$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/users/create",data:{username:l.username,uid:l.uid,token:l.token},success:function(a){l.id=a.id,$("#register-form").css("display","none"),setTimeout(function(){$("#welcome").css("display","none")},2e3)},error:function(a){$("#register-form").css("display","none"),alert("There was a problem logging in. Please try again"),g()}})}function j(){return l.id?$.ajax({method:"GET",url:"https://forge-api.herokuapp.com/games/user-games",headers:{user_id:l.id,token:l.token},success:function(a){},error:function(a){alert("There was a problem loading the profile. Please try again.")}}):(alert("Please Login or Register"),void f())}var k,l={uid:null,token:null,username:null,picture:null,id:null,games:null,joined:null,editGame:null},m="AIzaSyCe__2EGSmwp0DR-qKGqpYwawfmRsTLBEs",n="730683845367-tjrrmvelul60250evn5i74uka4ustuln.apps.googleusercontent.com";return gapi.load("client:auth2",d),{get:a,set:b,setGameEdit:c,games:j,register:i,signOut:g,signIn:f}}),angular.module("questCreator").controller("bgCtrl",function(a){}),angular.module("questCreator").controller("chatCtrl",function(a,b){$("form").submit(function(){return console.log("Submitted!"),a.emit("chat message",$("#m").val()),$("#m").val(""),!1}),a.off("chat message"),a.on("chat message",function(a){$("#messages").append($("<li>").text(a))})}),angular.module("questCreator").controller("detailCtrl",function(a,b){this.playGame=function(c){b.loadGame(c);a.go("main.game.play")},this.game={thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"}}),angular.module("questCreator").controller("editorCtrl",function(a,b,c,d){this.currentLargeView="maps",this.currentSmallView="objects",this.backgroundName="Testing Background",$(".asset").draggable({helper:"clone",start:function(a,b){$(b.helper).addClass("grabbed")},stop:function(a,b){$(b.helper).css({transition:"transform ease 100ms"}).removeClass("grabbed")}}),$("#bg-canvas").droppable({drop:function(a,b){console.log("ui",b);var c=$(b.draggable).clone();c.draggable(),$(this).append(c)}}),a.gameToEdit=d.get().editGame,a.editGame=function(){c.getGame(a.gameToEdit),$(".edit-game").hide()},a.createNewGame=function(b){c.createGame(b),$(".create-game").hide(),a.gameToEdit=b,d.setGameEdit(b)},a.cancel=function(){b.go("main.profile")}}),angular.module("questCreator").controller("entCtrl",function(a){}),angular.module("questCreator").controller("gameCtrl",function(a,b,c){}),angular.module("questCreator").controller("landingCtrl",function(a,b,c){b.createGame=function(){var d=c.get();d.id?(d.editGame=null,c.set(d),a.go("main.game.editor.views")):(alert("Please Sign In or Register."),b.signIn())},b.games=[{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"}],b.assets=[{name:"asset"},{name:"asset2"},{name:"asset3"},{name:"asset4"},{name:"asset5"},{name:"asset6"},{name:"asset7"},{name:"asset8"},{name:"asset9"},{name:"asset10"},{name:"asset11"},{name:"asset12"},{name:"asset13"},{name:"asset14"},{name:"asset15"},{name:"asset16"},{name:"asset17"},{name:"asset18"},{name:"asset19"},{name:"asset20"}]}),angular.module("questCreator").controller("mainCtrl",function(a,b,c,d){this.goHome=function(){b.go("main.landing")},this.goToUser=function(){var a=d.games();a.done(function(){b.go("main.profile")})},c.signIn=function(){d.signIn()},this.signOut=function(){d.signOut();var a={uid:null,token:null,username:null,picture:null,id:null,games:null,joined:null,editGame:null};d.set(a),b.go("main.landing")},this.register=function(a){d.register(a)},this.cancel=function(){$("#user-popup").css("display","none"),d.signOut()}}),angular.module("questCreator").controller("mapCtrl",function(a){}),angular.module("questCreator").controller("objCtrl",function(a){}),angular.module("questCreator").controller("playCtrl",function(a,b,c,d,e,f,g,h){function i(a){a.includes("look")?J.phrase="This is a description of your current scene. I hope it's helpful.":J.phrase="I don't understand that.",$(".dialog").text(J.phrase).show(),J.show=!0,L=!0}function j(){var a={found:!1,direction:"none",type:"none"};if(A.obj.collisionMap.forEach(function(b){var c=b.x+A.obj.pos.x,d=b.x+b.width+A.obj.pos.x,e=b.y+A.obj.pos.y,f=b.y+b.height+A.obj.pos.y;B.obj.collisionMap.forEach(function(b){var g=b.x,h=b.x+b.width,i=b.y,j=b.y+b.height;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",A.obj.speed.x>0?a.direction="right":A.obj.speed.x<0?a.direction="left":A.obj.speed.y<0?a.direction="up":A.obj.speed.y>0&&(a.direction="down"))}),C.obj.collisionMap.forEach(function(b){var g=b.x+C.obj.pos.x,h=b.x+b.width+C.obj.pos.x,i=b.y+C.obj.pos.y,j=b.y+b.height+C.obj.pos.y;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",A.obj.speed.x>0?a.direction="right":A.obj.speed.x<0?a.direction="left":A.obj.speed.y<0?a.direction="up":A.obj.speed.y>0&&(a.direction="down"))}),D.obj.collisionMap.forEach(function(b){var g=b.x+D.obj.pos.x,h=b.x+b.width+D.obj.pos.x,i=b.y+D.obj.pos.y,j=b.y+b.height+D.obj.pos.y;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",A.obj.speed.x>0?a.direction="right":A.obj.speed.x<0?a.direction="left":A.obj.speed.y<0?a.direction="up":A.obj.speed.y>0&&(a.direction="down"))})}),a.found){switch(a.type){case"wall":A.collide(a.direction)}a={found:!1,direction:"none",type:"none"}}}function k(){var a={found:!1,direction:"none",type:"none"};if(D.obj.collisionMap.forEach(function(b){var c=b.x+D.obj.pos.x,d=b.x+b.width+D.obj.pos.x,e=b.y+D.obj.pos.y,f=b.y+b.height+D.obj.pos.y;B.obj.collisionMap.forEach(function(b){var g=b.x,h=b.x+b.width,i=b.y,j=b.y+b.height;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",D.obj.speed.x>0?a.direction="right":D.obj.speed.x<0?a.direction="left":D.obj.speed.y<0?a.direction="up":D.obj.speed.y>0&&(a.direction="down"))}),C.obj.collisionMap.forEach(function(b){var g=b.x+C.obj.pos.x,h=b.x+b.width+C.obj.pos.x,i=b.y+C.obj.pos.y,j=b.y+b.height+C.obj.pos.y;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",D.obj.speed.x>0?a.direction="right":D.obj.speed.x<0?a.direction="left":D.obj.speed.y<0?a.direction="up":D.obj.speed.y>0&&(a.direction="down"))}),A.obj.collisionMap.forEach(function(b){var g=b.x+A.obj.pos.x,h=b.x+b.width+A.obj.pos.x,i=b.y+A.obj.pos.y,j=b.y+b.height+A.obj.pos.y;c<=h&&d>=g&&e<=j&&f>=i&&(a.found=!0,a.type="wall",D.obj.speed.x>0?a.direction="right":D.obj.speed.x<0?a.direction="left":D.obj.speed.y<0?a.direction="up":D.obj.speed.y>0&&(a.direction="down"))})}),a.found){switch(a.type){case"wall":D.collide(a.direction)}a={found:!1,direction:"none",type:"none"}}}function l(){A.updatePos()}function m(){D.updatePos()}function n(){"walkLeft"!==A.action&&"walkUp"!==A.action&&"walkRight"!==A.action&&"walkDown"!==A.action||(T>A.obj.animate[A.action].length-1&&(T=0),A.obj.currentFrame=A.obj.animate[A.action][T],T++)}function o(){U>C.obj.animate[C.allActions[0]].length-1&&(U=0),C.obj.currentFrame=C.obj.animate[C.allActions[0]][U],U++}function p(){if("stand"===D.action||"walkLeft"===D.action||"walkUp"===D.action||"walkRight"===D.action||"walkDown"===D.action){switch(D.action){case"walkLeft":D.obj.speed.x=-1,D.obj.speed.y=0;break;case"walkUp":D.obj.speed.x=0,D.obj.speed.y=-1;break;case"walkRight":D.obj.speed.x=1,D.obj.speed.y=0;break;case"walkDown":D.obj.speed.x=0,D.obj.speed.y=1}V>D.obj.animate[D.action].length-1&&(V=0),D.obj.currentFrame=D.obj.animate[D.action][V],V++}}function q(){x.save(),x.translate(A.obj.pos.x,A.obj.pos.y),A.obj.currentFrame.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.globalAlpha=.2,A.obj.collisionMap.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.restore()}function r(){x.save(),x.globalCompositeOperation="destination-over";for(var a=B.obj.image.length-1;a>=0;a--){var b=B.obj.image[a];x.fillStyle=b.color,x.fillRect(b.x,b.y,b.width,b.height)}x.globalCompositeOperation="source-over",x.globalAlpha=.2,B.obj.collisionMap.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.restore()}function s(){x.save(),x.translate(C.obj.pos.x,C.obj.pos.y),x.globalCompositeOperation="destination-over",C.obj.currentFrame.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.globalAlpha=.2,C.obj.collisionMap.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.restore()}function t(){x.save(),x.translate(D.obj.pos.x,D.obj.pos.y),x.globalCompositeOperation="destination-over",D.obj.currentFrame.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.globalAlpha=.2,D.obj.collisionMap.forEach(function(a){x.fillStyle=a.color,x.fillRect(a.x,a.y,a.width,a.height)}),x.restore()}function u(){x.clearRect(0,0,y,z)}function v(){u(),E&&F&&G&&H&&!W&&(Q.obj={avatar:A,background:B,objects:[C],entities:[D]},A=Q.obj.avatar,B=Q.obj.background,C=Q.obj.objects[0],D=Q.obj.entities[0],W=!0,console.log(Q),console.log(JSON.stringify(Q.obj))),W&&(j(),k(),l(),m(),q(),t(),s(),r()),requestAnimationFrame(v)}var w=document.getElementById("play-canvas"),x=w.getContext("2d"),y=700,z=500,A=null,B=null,C=null,D=null,E=!1,F=!1,G=!1,H=!1,I={show:!1,phrase:""},J={show:!1,phrase:""},K={show:!1,contents:""},L=!1,M=(new Date,{name:"Avatar Test",obj:{pos:{x:100,y:100},speed:{mag:3,x:0,y:0},animate:{walkLeft:[[{x:100,y:100,width:30,height:30,color:"blue"},{x:110,y:150,width:30,height:30,color:"green"}],[{x:110,y:100,width:30,height:30,color:"blue"},{x:100,y:150,width:30,height:30,color:"green"}]],walkRight:[[{x:150,y:100,width:30,height:30,color:"blue"},{x:140,y:150,width:30,height:30,color:"green"}],[{x:140,y:100,width:30,height:30,color:"blue"},{x:150,y:150,width:30,height:30,color:"green"}]],walkUp:[[{x:100,y:110,width:30,height:30,color:"red"},{x:150,y:100,width:30,height:30,color:"yellow"}],[{x:100,y:100,width:30,height:30,color:"red"},{x:150,y:110,width:30,height:30,color:"yellow"}]],walkDown:[[{x:100,y:140,width:30,height:30,color:"red"},{x:150,y:150,width:30,height:30,color:"yellow"}],[{x:100,y:150,width:30,height:30,color:"red"},{x:150,y:140,width:30,height:30,color:"yellow"}]],swimLeft:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimRight:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimUp:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimDown:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]]},collisionMap:[{x:100,y:180,width:80,height:10,color:"gray"},{x:100,y:185,width:80,height:10,color:"gray"}]},current:!1}),N={name:"Beige Background",obj:{image:[{x:0,y:0,width:y,height:z,color:"beige"},{x:150,y:150,width:50,height:50,color:"yellow"}],collisionMap:[{type:"wall",x:150,y:200,width:50,height:20,color:"gray"}]},game_id:1,tags:["Testing Stuff","Plain beige"],public:!0},O={name:"Object Test",obj:{pos:{x:400,y:300},animate:{wave:[[{x:0,y:0,width:10,height:100,color:"brown"},{x:0,y:0,width:50,height:10,color:"red"},{x:50,y:10,width:50,height:10,color:"red"}],[{x:0,y:0,width:10,height:100,color:"brown"},{x:0,y:10,width:50,height:10,color:"red"},{x:50,y:0,width:50,height:10,color:"red"}]]},collisionMap:[{x:-10,y:100,width:10,height:10,color:"gray"},{x:0,y:100,width:10,height:10,color:"gray"},{x:0,y:100,width:10,height:10,color:"gray"}]},game_id:1,tags:["Object thing","Really fun new object"],public:!1},P={name:"AI Entity Test",obj:{pos:{x:50,y:220},speed:{mag:3,x:0,y:0},animate:{stand:[[{x:100,y:100,width:30,height:30,color:"orange"},{x:150,y:100,width:30,height:30,color:"purple"}],[{x:110,y:100,width:30,height:30,color:"orange"},{x:140,y:100,width:30,height:30,color:"purple"}]],walkLeft:[[{x:100,y:100,width:30,height:30,color:"purple"},{x:110,y:150,width:30,height:30,color:"orange"}],[{x:110,y:100,width:30,height:30,color:"purple"},{x:100,y:150,width:30,height:30,color:"orange"}]],walkRight:[[{x:150,y:100,width:30,height:30,color:"purple"},{x:140,y:150,width:30,height:30,color:"orange"}],[{x:140,y:100,width:30,height:30,color:"purple"},{x:150,y:150,width:30,height:30,color:"orange"}]],walkUp:[[{x:100,y:110,width:30,height:30,color:"purple"},{x:150,y:100,width:30,height:30,color:"orange"}],[{x:100,y:100,width:30,height:30,color:"purple"},{x:150,y:110,width:30,height:30,color:"orange"}]],walkDown:[[{x:100,y:140,width:30,height:30,color:"purple"},{x:150,y:150,width:30,height:30,color:"orange"}],[{x:100,y:150,width:30,height:30,color:"purple"},{x:150,y:140,width:30,height:30,color:"orange"}]],swimLeft:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimRight:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimUp:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimDown:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]]},collisionMap:[{x:100,y:180,width:80,height:10,color:"gray"},{x:100,y:185,width:80,height:10,color:"gray"}]},game_id:1,tags:["Entity thing","Awesome entity ftw"],public:!1},Q={name:"Scene Test 3",description:"This is the opening scene for my game.",obj:{},game_id:1,map_id:1},R={game_id:1,name:"Map Test 2",description:"This is the main map for my game",obj:{canvasElems:[{x:100,y:100,width:30,height:30,color:"blue"}],collisionMap:[{x:300,y:300,width:30,height:30,color:"red"}]}},S={name:"Game Test 2",description:"This is my game",obj:{canvasElems:[{x:100,y:100,width:30,height:30,color:"blue"}],collisionMap:[{x:300,y:300,width:30,height:30,color:"red"}]},tags:["The best game","fun stuff","Everybody's favorite"],public:!1};$(".createAvatarBgObjEntityBtn").click(function(){var a={user_id:f.get().id,token:f.get().token};$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/characters/create",headers:a,data:JSON.stringify(M),dataType:"json",contentType:"application/json",success:function(a){A=new b(a),A.obj.currentFrame=A.obj.animate.walkLeft[0],E=!0,setInterval(n,75)},error:function(a){console.log(a)}}),$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/backgrounds/create",headers:a,data:JSON.stringify(N),dataType:"json",contentType:"application/json",success:function(a){B=new c(a),F=!0},error:function(a){console.log(a)}}),$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/obstacles/create",headers:a,data:JSON.stringify(O),dataType:"json",contentType:"application/json",success:function(a){C=new d(a),C.allActions=Object.keys(C.obj.animate),C.action=C.allActions[0],C.obj.currentFrame=C.obj.animate[C.action][0],G=!0,setInterval(o,75)},error:function(a){console.log(a)}}),$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/entities/create",headers:a,data:JSON.stringify(P),dataType:"json",contentType:"application/json",success:function(a){D=new e(a),console.log(D),D.obj.currentFrame=D.obj.animate[D.action][0],H=!0,setInterval(p,75)},error:function(a){console.log(a)}})}),$(".createSceneBtn").click(function(){var a={user_id:f.get().id,token:f.get().token};$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/scenes/create",headers:a,data:JSON.stringify(Q),dataType:"json",contentType:"application/json",success:function(a){console.log(a)},error:function(a){console.log(a)}})}),$(".createMapBtn").click(function(){var a={user_id:f.get().id,token:f.get().token};$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/maps/create",headers:a,data:JSON.stringify(R),dataType:"json",contentType:"application/json",success:function(a){console.log(a)},error:function(a){console.log(a)}})}),$(".createGameBtn").click(function(){var a={user_id:f.get().id,token:f.get().token};$.ajax({method:"POST",url:"https://forge-api.herokuapp.com/games/create",headers:a,data:JSON.stringify(S),dataType:"json",contentType:"application/json",success:function(a){console.log(a)},error:function(a){console.log(a)}})}),$("body").off("keyup").on("keyup",function(a){var b=a.which;37===b?(A.action="walkLeft"===A.action?"stand":"walkLeft",A.obj.speed.x=A.obj.speed.x===-1*A.obj.speed.mag?0:-1*A.obj.speed.mag,A.obj.speed.y=0):38===b?(A.action="walkUp"===A.action?"stand":"walkUp",A.obj.speed.x=0,A.obj.speed.y=A.obj.speed.y===-1*A.obj.speed.mag?0:-1*A.obj.speed.mag):39===b?(A.action="walkRight"===A.action?"stand":"walkRight",A.obj.speed.x=A.obj.speed.x===A.obj.speed.mag?0:A.obj.speed.mag,A.obj.speed.y=0):40===b&&(A.action="walkDown"===A.action?"stand":"walkDown",A.obj.speed.x=0,A.obj.speed.y=A.obj.speed.y===A.obj.speed.mag?0:A.obj.speed.mag)}),$("body").off("keypress").on("keypress",function(a){var b=a.which;if(I.show&&b>=32&&b<=220&&!J.show&&0===$(".active").length){L=!0;var c=String.fromCharCode(b);I.phrase+=c,$(".typing").text(I.phrase)}else if(13===b){if(I.show){I.show=!1,$(".typing").hide();var d=I.phrase;I.phrase="",i(d)}else J.show?(J.show=!1,$(".dialog").hide(),J.phrase=""):K.show;J.show||K.show||0!==$(".active").length||(L=!1)}else 32===b&&(I.show||(I.phrase=">",I.show=!0,$(".typing").text(I.phrase).show()))});var T=0,U=0,V=0,W=!1;requestAnimationFrame(v)}),angular.module("questCreator").controller("profileCtrl",function(a,b,c,d){c.createGame=function(){b.go("main.game.editor.views")},c.editGame=function(a){c.user.editGame=a,d.set(c.user),b.go("main.game.editor.views")},setTimeout(function(){c.user=d.get(),c.getJoinedDate=function(a){return new Date(a)},c.$apply()},1e3),c.games=[{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"},{thumbnail:"http://cdn.akamai.steamstatic.com/steam/apps/345390/extras/KQ_CC-PC_Bundle-Art_Capsule_Main.png?t=1477527248",name:"King's Quest Collection",creator:"billy badass",players:6,created_at:new Date,responseText:"something"}],c.avatarTest={walkLeft:[[{x:100,y:100,width:30,height:30,color:"blue"},{x:150,y:150,width:30,height:30,color:"green"}],[{x:100,y:100,width:30,height:30,color:"red"},{x:150,y:150,width:30,height:30,color:"yellow"}]],walkRight:[[{x:100,y:100,width:30,height:30,color:"blue"},{x:150,y:150,width:30,height:30,color:"green"}],[{x:100,y:100,width:30,height:30,color:"red"},{x:150,y:150,width:30,height:30,color:"yellow"}]],walkUp:[[{x:100,y:100,width:30,height:30,color:"blue"},{x:150,y:150,width:30,height:30,color:"green"}],[{x:100,y:100,width:30,height:30,color:"red"},{x:150,y:150,width:30,height:30,color:"yellow"}]],walkDown:[[{x:100,y:100,width:30,height:30,color:"blue"},{x:150,y:150,width:30,height:30,color:"green"}],[{x:100,y:100,width:30,height:30,color:"red"},{x:150,y:150,width:30,height:30,color:"yellow"}]],swimLeft:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimRight:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimUp:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]],swimDown:[[{x:100,y:100,width:30,height:30,color:"lightblue"},{x:150,y:150,width:30,height:30,color:"lightblue"}],[{x:100,y:100,width:30,height:30,color:"gray"},{x:150,y:150,width:30,height:30,color:"gray"}]]}}),angular.module("questCreator").controller("sceneCtrl",function(a,b,c){function d(a,b,c,d,e){this.x=a,this.y=b,this.width=c,this.height=d,this.color=e,this.draw=function(){k.draw.fillStyle=this.color,window.innerWidth<=o?k.draw.fillRect(this.x*r,this.y*s,this.width,this.height):window.innerWidth<=p?k.draw.fillRect(this.x*q,this.y/q,this.width,this.height):k.draw.fillRect(this.x,this.y,this.width,this.height)}}function e(a){l===-1&&(l=setInterval(g,100))}function f(a){l!==-1&&(clearInterval(l),l=-1)}function g(){if(k.canvasPos={x:k.myCanvas.getBoundingClientRect().left,y:k.myCanvas.getBoundingClientRect().top},u&&v.background){var a=w,b=x,c=k.currentColor;if("mouse"===t){var e=m-k.canvasPos.x,f=n-k.canvasPos.y,g=!1;if(k.allBackgroundSquares.forEach(function(a){a.x===e&&a.y===f&&(g=!0)}),!g){var h=new d(m-k.canvasPos.x,n-k.canvasPos.y,a,b,c);h.draw(),k.allBackgroundSquares.push(h)}}else if("touch"===t){var h=new d(j.clientX-a/2-k.canvasPos.x,j.clientY-b/2-k.canvasPos.y,a,b,c);h.draw(),k.allBackgroundSquares.push(h)}u=!1}}function h(){for(var a=0;a<k.allBackgroundSquares.length;a++){var b=k.allBackgroundSquares[a];b.draw()}}var i,j,k=this,l=-1,m=0,n=0,o=850,p=1100,q=1.4,r=2.5,s=1.6,t="",u=!1,v={background:!0},w=10,x=10,y=[];this.speedRange=5,this.currentColor="#005500",this.myCanvas=document.getElementById("bg-canvas"),this.canvasPos={x:k.myCanvas.getBoundingClientRect().left,y:k.myCanvas.getBoundingClientRect().top},this.draw=this.myCanvas.getContext("2d"),this.backgroundName="Testing Background",this.allBackgroundSquares=[],$("#undo").click(function(){if(v.background&&k.allBackgroundSquares.length>0){var a=k.allBackgroundSquares.pop();y.push(a)}k.draw.clearRect(0,0,k.myCanvas.width,k.myCanvas.height),h()}),$("#redo").click(function(){if(v.background&&y.length>0){var a=y.pop();k.allBackgroundSquares.push(a)}k.draw.clearRect(0,0,k.myCanvas.width,k.myCanvas.height),h()}),$("#clear").click(function(){canvasWidth=k.myCanvas.width,canvasHeight=k.myCanvas.height,k.draw.clearRect(0,0,canvasWidth,canvasHeight),k.allBackgroundSquares=[]}),$("#save").click(function(){console.log(k.allBackgroundSquares)}),$(k.myCanvas).on("mousedown",e),$(k.myCanvas).on("mouseup",f),$(k.myCanvas).on("mouseleave",f),$(k.myCanvas).on("mousemove",function(a){newMouseX=Math.round((a.clientX-w/2)/w)*w,newMouseY=Math.round((a.clientY-x/2)/x)*x,newMouseX===m&&newMouseY===n||(m=newMouseX,n=newMouseY,t="mouse",i=a,u=!0)}),$(k.myCanvas).on("touchstart",e),$(k.myCanvas).on("touchend",f),$(k.myCanvas).on("touchcancel",f),$(k.myCanvas).on("touchmove",function(a){t="touch",a.preventDefault(),j=a.touches[0],u=!0}),console.log("here")}),angular.module("questCreator").controller("scriptsCtrl",function(a){});